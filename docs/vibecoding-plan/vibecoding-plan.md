# VibeCoding計画書 - サークル運営支援Bot

Generated by Cursor

## 1. プロジェクト概要

### 目的
- サークル運営業務の効率化
- タスク管理の一元化
- メール通知の集約
- 運営業務の「見える化」と「共有化」の実現

### 主要機能
1. タスク管理機能
2. メール通知機能（Outlook連携）

### 開発期間
- 全体期間：6週間
- PoC期間：3週間

## 2. 開発フェーズ

### フェーズ1: 環境構築と基盤開発（1週間）

| タスク | 説明 | 担当 | 見積時間 | 依存関係 |
|-------|------|------|----------|----------|
| 開発環境セットアップ | Poetry、Ruff、pytestの設定 | 開発者 | 2h | なし |
| GitHubリポジトリ設定 | リポジトリ作成、GitHub Actions設定 | 開発者 | 2h | なし |
| Supabaseプロジェクト作成 | データベース初期設定、RLS設定 | DB担当 | 2h | なし |
| マイグレーション作成 | テーブル定義のマイグレーションファイル作成 | DB担当 | 4h | Supabase設定 |
| Discord Bot基盤実装 | discord.pyの基本設定、イベントハンドラー実装 | Bot担当 | 4h | 開発環境 |
| FastAPI基盤実装 | プロジェクト構造、ミドルウェア設定 | API担当 | 4h | 開発環境 |

### フェーズ2: タスク管理機能実装（2週間）

| タスク | 説明 | 担当 | 見積時間 | 依存関係 |
|-------|------|------|----------|----------|
| タスクモデル実装 | SQLAlchemyモデル、CRUD操作の実装 | DB担当 | 4h | マイグレーション |
| タスク登録コマンド | `/task add`コマンドの実装 | Bot担当 | 6h | タスクモデル |
| タスク一覧表示 | `/task list`コマンドの実装 | Bot担当 | 4h | タスクモデル |
| タスク詳細表示 | `/task detail`コマンドの実装 | Bot担当 | 4h | タスクモデル |
| タスク編集機能 | `/task edit`コマンドの実装 | Bot担当 | 6h | タスクモデル |
| タスク完了機能 | `/task done`とリアクション処理の実装 | Bot担当 | 4h | タスクモデル |
| リマインド機能 | APSchedulerによる自動リマインド実装 | Bot担当 | 8h | タスク登録 |
| タスクAPI実装 | FastAPIエンドポイント実装 | API担当 | 8h | タスクモデル |

### フェーズ3: メール連携機能実装（2週間）

| タスク | 説明 | 担当 | 見積時間 | 依存関係 |
|-------|------|------|----------|----------|
| OAuth2実装 | Microsoft Graph API認証フロー実装 | API担当 | 8h | FastAPI基盤 |
| メール連携モデル | SQLAlchemyモデル、CRUD操作の実装 | DB担当 | 4h | マイグレーション |
| メール連携コマンド | `/mail connect`コマンドの実装 | Bot担当 | 6h | OAuth2実装 |
| メール取得処理 | Microsoft Graph APIによるメール取得実装 | Bot担当 | 8h | メール連携 |
| メール通知機能 | Discord Embedによる通知実装 | Bot担当 | 6h | メール取得 |
| トークン更新処理 | リフレッシュトークンの自動更新実装 | API担当 | 4h | OAuth2実装 |

### フェーズ4: テストと品質向上（1週間）

| タスク | 説明 | 担当 | 見積時間 | 依存関係 |
|-------|------|------|----------|----------|
| ユニットテスト作成 | 各機能のテストコード実装 | 全員 | 16h | 全機能実装 |
| 統合テスト作成 | E2Eテストシナリオ実装 | テスト担当 | 8h | ユニットテスト |
| パフォーマンステスト | 負荷テストとボトルネック特定 | インフラ担当 | 8h | 統合テスト |
| セキュリティレビュー | 脆弱性診断、トークン管理確認 | セキュリティ担当 | 8h | 全機能実装 |
| コードレビュー | コード品質、規約準拠の確認 | リードエンジニア | 8h | 全実装完了 |

## 3. テスト戦略

### ユニットテスト
- pytestによる自動テスト
- モックを使用した外部サービステスト
- カバレッジ目標：80%以上

### 統合テスト
- エンドツーエンドのシナリオテスト
- Discord Bot操作の自動化テスト
- メール連携の統合テスト

### 性能テスト
- 同時実行時のレスポンス時間測定
- メモリ使用量の監視
- データベースクエリの最適化確認

## 4. リリース計画

### ステージング環境デプロイ（フェーズ4終了後）
1. インフラストラクチャのセットアップ
2. CI/CDパイプラインの確認
3. 統合テストの実行
4. 性能測定

### 本番環境デプロイ
1. 本番環境の構築
2. データベースマイグレーション
3. アプリケーションデプロイ
4. 監視設定の有効化

## 5. リスクと対策

| リスク | 影響度 | 対策 |
|-------|--------|------|
| Discord API制限 | 高 | レート制限の実装、キャッシュ活用 |
| メールAPI認証切れ | 高 | トークン自動更新、エラー通知 |
| データベース容量 | 中 | 定期クリーンアップ、監視設定 |
| 障害発生 | 中 | Sentryによる監視、ログ収集 |

## 6. 開発環境と必要なツール

### 必須ツール
- Python 3.11以上
- Poetry
- Docker
- Git
- Supabase CLI
- Vercel CLI
- Fly.io CLI

### 開発環境設定
- VSCode + 推奨拡張機能
- Ruffによるコード品質管理
- pre-commitフック設定

## 7. チーム構成と役割

### コアチーム
- プロジェクトリード（1名）
- バックエンド開発者（2名）
- インフラ担当（1名）
- QA担当（1名）

### 役割分担
- Bot開発：バックエンド開発者1
- API開発：バックエンド開発者2
- インフラ構築：インフラ担当
- テスト管理：QA担当
- レビュー：プロジェクトリード

## 8. まとめ

### 成功基準（KPI）
- タスク登録数：週5件以上
- タスク完了率：80%以上
- メール通知成功数：週3件以上
- エラー発生率：1%未満

### マイルストーン
1. 環境構築完了（Week 1）
2. タスク管理機能リリース（Week 3）
3. メール連携機能リリース（Week 5）
4. 本番環境リリース（Week 6）

### 進捗管理
- 週次進捗レビュー
- デイリースタンドアップ
- GitHub Projectsでのタスク管理
